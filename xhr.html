<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script  src="http://libs.baidu.com/jquery/1.7.2/jquery.min.js"></script>
    <script src="src/js/uploads.js"></script>
</head>
<body>

    <input  name="file" type="file"  id="file" onchange="upload(this)"/>
    <!--<input  name="file" type="button"   onclick="upload(this)" />-->

</body>
   <script>

       function upload(obj) {

           // getData();

           $("#file").bigFile({
               url:"xhr.php",
               callback:function (re) {
                   console.log(re);

               },
               percent:function (re) {

                   console.log(re);

               }

           });

           // bigFile.upload('xhr.php',$(obj)[0].files[0],function (data) {
           //
           //
           //     console.log(data);
           //
           // });
       }


       

//
//       var slice_size=1024*1024;//将文件切割成这个大小
//
//       var totalBlobNum=0;//文件总块数
//
//       var blobNum=1;//当前是第几块
//
//       var i=0;//计数器
//
//       function upload() {
//
//
//
//           var data = new FormData();//这个就是模拟表单
//
//
//
//           //文件对象，这个是文件的数据
//           f=$("#file")[0].files[0];
//
//
//           //总块数
//           totalBlobNum=(Math.ceil(f.size/slice_size));
//
//
//
//
//                var s = blobSlice(f, i*slice_size, Number(i*slice_size)+Number(slice_size));//这里第三参数不是长度，是起读点到终点，公式为 start+length
//
//
//                 console.log(i*slice_size+"-----------------------"+Number(i*slice_size)+Number(slice_size));
//
//
//
//                // console.log(s);
//
//
//
//
//                data.append('file_name', f.name);//文件名
//
//
//                data.append('total_blob_num', totalBlobNum);//总块数
//
//                data.append('blob_num',blobNum);//当前是第几块
//
//
//
//                blobNum++;
//
//
//
//                data.append('file', s);//当前块的数据
//
//
//
//
//
//
// //
//                $.ajax({
//                    url:"xhr.php",
//                    type:"post",
//                    data:data,
//
//                    cache: false,//不缓存
//                    processData: false,//processData设置为false。因为data值是FormData对象，不需要对数据做处理。
//                    contentType: false,//contentType设置为false。因为是由<form>表单构造的FormData对象，且已经声明了属性enctype="multipart/form-data"，所以这里设置为false。
//                    success:function (re) {
//
//
//                        re=JSON.parse(re);
//
//                        // console.log(re);
//
//                        if(re.code==1){
//
//                            i++;
//
//                            //返回1为还未传完，等待后续文件
//                            upload();
//
//                        }else if(re.code==2) {
//
//                            //初始化，等待下一个文件继续
//                            i=0;
//                            blobNum=1;
//                            totalBlobNum=0;
//
//                            alert('上传成功！');
//
//
//                        }
//
//
//
//                    }
//
//
//                });
//
//
//
//
//
//
//
//
//
//
//       }
//
//       /**
//        *
//        * @param blob       文件对象
//        * @param startByte  开始字节的位置
//        * @param length     长度
//        * @returns {*}      返回blob对象
//        */
//       function blobSlice(blob,startByte,length) {
//
//
//
//           if(blob.slice){
//               return blob.slice(startByte,length);
//
//
//           }else if(blob.webitSlice){
//
//               return blob.webkitSlice(startByte,length);
//
//           }else if(blob.mozSlice){
//
//               return blob.mozSlice(startByte,length);
//
//           }else {
//
//
//               return null;
//           }
//
//
//
//       }



   </script>

</html>